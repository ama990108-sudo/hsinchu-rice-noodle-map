<!DOCTYPE html> <html lang="zh-Hant"> <head>   <meta charset="utf-8"/>   <meta name="viewport" content="width=device-width, initial-scale=1"/>   <title>新竹米粉地圖 | Hsinchu Rice Noodle Map</title>   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">   <style>     * {       box-sizing: border-box;       margin: 0;       padding: 0;     }          body {       font-family: 'Segoe UI', 'PingFang TC', 'Microsoft JhengHei', sans-serif;       background: linear-gradient(135deg, #fff5f5, #fff9f2);       color: #333;       line-height: 1.6;       min-height: 100vh;       padding-bottom: 20px;     }          header {       background: linear-gradient(to right, #c62828, #d32f2f);       color: #fff;       padding: 16px 20px;       display: flex;       align-items: center;       gap: 15px;       box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);       position: sticky;       top: 0;       z-index: 1000;     }          .logo {       display: flex;       align-items: center;       gap: 10px;     }          .logo-icon {       font-size: 1.8rem;     }          header h1 {       margin: 0;       font-size: 1.4rem;       font-weight: 700;     }          .spacer {       flex: 1;     }          .lang-btn {       background: rgba(255, 255, 255, 0.9);       color: #c62828;       border: none;       border-radius: 50px;       padding: 8px 16px;       font-weight: 700;       cursor: pointer;       transition: all 0.3s ease;       box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);       display: flex;       align-items: center;       gap: 6px;     }          .lang-btn:hover {       background: #fff;       transform: translateY(-2px);       box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);     }          #map-container {       position: relative;       height: 60vh;       border-bottom: 1px solid #e0e0e0;     }          #map {       height: 100%;     }          .map-overlay {       position: absolute;       top: 15px;       right: 15px;       background: rgba(255, 255, 255, 0.9);       padding: 12px;       border-radius: 10px;       box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);       z-index: 500;       max-width: 220px;     }          .map-overlay h3 {       color: #c62828;       margin-bottom: 8px;       font-size: 1rem;     }          .map-overlay ul {       list-style: none;       padding: 0;     }          .map-overlay li {       padding: 6px 0;       border-bottom: 1px solid #eee;       display: flex;       align-items: center;     }          .map-overlay li:last-child {       border-bottom: none;     }          .map-overlay .marker-color {       display: inline-block;       width: 12px;       height: 12px;       background: #c62828;       border-radius: 50%;       margin-right: 8px;     }          main {       max-width: 1200px;       margin: 25px auto;       padding: 0 15px;     }          .panel {       background: #fff;       border-radius: 16px;       box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);       padding: 22px;       margin-bottom: 25px;       transition: transform 0.3s ease;     }          .panel:hover {       transform: translateY(-5px);     }          h2 {       color: #c62828;       margin: 0 0 20px;       font-size: 1.6rem;       display: flex;       align-items: center;       gap: 10px;       padding-bottom: 12px;       border-bottom: 2px solid #ffebee;     }          h2 i {       font-size: 1.4rem;     }          .route-desc {       color: #555;       margin-bottom: 15px;       line-height: 1.7;     }          .links {       display: flex;       flex-wrap: wrap;       gap: 12px;       margin-top: 20px;     }          .link-btn {       display: inline-flex;       align-items: center;       gap: 8px;       padding: 10px 18px;       background: #ffebee;       color: #c62828;       border-radius: 50px;       text-decoration: none;       font-weight: 600;       transition: all 0.3s ease;       box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);     }          .link-btn:hover {       background: #ffcdd2;       transform: translateY(-3px);       box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);     }          .shop-list {       display: grid;       grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));       gap: 20px;     }          .shop-card {       border-radius: 12px;       overflow: hidden;       background: #fff;       box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);       transition: all 0.3s ease;       display: flex;       flex-direction: column;       height: 100%;     }          .shop-card:hover {       transform: translateY(-5px);       box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);     }          .shop-header {       background: linear-gradient(to right, #c62828, #d32f2f);       color: white;       padding: 15px;     }          .shop-header h3 {       margin: 0;       font-size: 1.2rem;     }          .shop-body {       padding: 18px;       flex-grow: 1;       display: flex;       flex-direction: column;     }          .shop-desc {       color: #555;       margin-bottom: 15px;       flex-grow: 1;     }          .rating-section {       margin: 12px 0;     }          .rating-title {       font-weight: 600;       color: #5d4037;       margin-bottom: 8px;       display: flex;       align-items: center;       gap: 6px;     }          .rating-display {       display: flex;       align-items: center;       gap: 10px;       margin-bottom: 5px;     }          .avg-rating {       font-weight: 700;       font-size: 1.4rem;       color: #c62828;     }          .rating-count {       font-size: 0.9rem;       color: #757575;     }          .stars {       display: flex;       gap: 3px;       margin: 10px 0;     }          .star {       font-size: 1.4rem;       cursor: pointer;       color: #e0e0e0;       transition: color 0.2s;     }          .star.active {       color: #f6b400;     }          .star:hover {       color: #ffd54f;     }          .shop-actions {       display: flex;       gap: 12px;       margin-top: 15px;     }          .action-btn {       flex: 1;       display: flex;       align-items: center;       justify-content: center;       gap: 6px;       padding: 10px;       border-radius: 8px;       text-decoration: none;       font-weight: 600;       transition: all 0.3s ease;     }          .map-btn {       background: #e3f2fd;       color: #1976d2;     }          .rate-btn {       background: #f1f8e9;       color: #388e3c;     }          .action-btn:hover {       transform: translateY(-3px);       box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);     }          .feedback-section textarea {       width: 100%;       min-height: 120px;       border-radius: 12px;       border: 1px solid #e0e0e0;       padding: 15px;       font-family: inherit;       font-size: 1rem;       resize: vertical;       transition: all 0.3s;       margin-top: 10px;     }          .feedback-section textarea:focus {       outline: none;       border-color: #c62828;       box-shadow: 0 0 0 3px rgba(198, 40, 40, 0.1);     }          .note {       font-size: 0.9rem;       color: #757575;       margin-top: 15px;       text-align: center;       padding: 10px;       background: #f5f5f5;       border-radius: 8px;     }          footer {       text-align: center;       color: #757575;       font-size: 0.9rem;       padding: 20px;       margin-top: 30px;     }          .loading {       display: inline-block;       width: 20px;       height: 20px;       border: 3px solid rgba(198, 40, 40, 0.2);       border-radius: 50%;       border-top-color: #c62828;       animation: spin 1s linear infinite;       margin-right: 8px;       vertical-align: middle;     }          @keyframes spin {       to {         transform: rotate(360deg);       }     }          .user-rating {       font-weight: 600;       color: #5d4037;       margin-top: 8px;     }          /* 響應式設計 */     @media (max-width: 768px) {       .shop-list {         grid-template-columns: 1fr;       }              header {         padding: 12px 15px;       }              .panel {         padding: 18px;       }              #map-container {         height: 50vh;       }     }          @media (max-width: 480px) {       .lang-btn {         padding: 6px 12px;         font-size: 0.9rem;       }              header h1 {         font-size: 1.2rem;       }              .shop-actions {         flex-direction: column;       }     }   </style> </head> <body> <header>   <div class="logo">     <i class="fas fa-utensils logo-icon"></i>     <h1 id="title">新竹米粉地圖</h1>   </div>   <div class="spacer"></div>   <button class="lang-btn" id="langBtn">     <i class="fas fa-language"></i>     <span>EN</span>   </button> </header>  <div id="map-container">   <div id="map"></div>   <div class="map-overlay">     <h3><i class="fas fa-info-circle"></i> 地圖說明</h3>     <ul>       <li><span class="marker-color"></span> 紅色標記：米粉店家位置</li>       <li>點擊標記查看店家資訊</li>       <li>拖動地圖瀏覽不同區域</li>     </ul>   </div> </div>  <main>   <section class="panel">     <h2><i class="fas fa-route"></i> <span id="routeTitle">路線說明</span></h2>     <p class="route-desc" id="routeDesc">以新竹火車站與城隍廟為核心，步行可達的經典米粉店。點擊地圖紅點可查看並前往 Google 地圖。</p>          <div class="links">       <a href="https://www.google.com/maps/search/?api=1&query=新竹火車站"           target="_blank"           class="link-btn">         <i class="fas fa-train"></i> 新竹火車站       </a>       <a href="https://www.google.com/maps/search/?api=1&query=新竹城隍廟"           target="_blank"           class="link-btn">         <i class="fas fa-torii-gate"></i> 新竹城隍廟       </a>     </div>   </section>    <section class="panel">     <h2><i class="fas fa-utensils"></i> <span id="listTitle">店家清單（可評分）</span></h2>     <div class="shop-list" id="shopList"></div>   </section>    <section class="panel feedback-section">     <h2><i class="fas fa-comment-dots"></i> <span id="fbTitle">意見回饋</span></h2>     <p id="fbDesc">此回饋僅儲存在你的瀏覽器（localStorage）</p>     <textarea id="feedback" placeholder="寫下你對這張地圖的建議…"></textarea>     <div class="note" id="foot">提示：評分與回饋使用瀏覽器 localStorage，重新整理仍會保留。</div>   </section> </main>  <footer>   <p>新竹米粉地圖 &copy; 2023 | 探索新竹美食文化</p> </footer>  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script> <script>   // 店家數據   const shops = [     {       id: "dongmen",       zh: { name: "東門米粉攤（東門市場）", desc: "在地人氣、芋頭米粉湯代表" },       en: { name: "Dongmen Rice Noodles (Dongmen Market)", desc: "Local favorite with taro rice noodle soup" },       lat: 24.8046,        lng: 120.9715,       g: "https://www.google.com/maps/search/?api=1&query=東門米粉攤 新竹",       formLink: "#"     },     {       id: "acheng",       zh: { name: "阿城米粉", desc: "靠近城隍廟，湯頭清甜" },       en: { name: "A-Cheng Rice Noodles", desc: "Near Chenghuang Temple; light, sweet broth" },       lat: 24.8039,        lng: 120.9659,       g: "https://www.google.com/maps/search/?api=1&query=阿城米粉 新竹",       formLink: "#"     },     {       id: "temple",       zh: { name: "城隍廟口米粉", desc: "廟口小吃聚集地" },       en: { name: "Chenghuang Temple Rice Noodles", desc: "Temple-front street food area" },       lat: 24.8043,        lng: 120.9666,       g: "https://www.google.com/maps/search/?api=1&query=城隍廟口 米粉 新竹",       formLink: "#"     },     {       id: "zhenji",       zh: { name: "珍記米粉湯", desc: "火車站周邊老字號" },       en: { name: "Zhen Ji Rice Noodle Soup", desc: "Classic shop near the train station" },       lat: 24.8019,        lng: 120.9719,       g: "https://www.google.com/maps/search/?api=1&query=珍記米粉湯 新竹",       formLink: "#"     },     {       id: "central",       zh: { name: "中央市場米粉攤", desc: "市場系風味，早午餐熱鬧" },       en: { name: "Central Market Rice Noodles", desc: "Market-style noodles, busy mornings" },       lat: 24.8032,        lng: 120.9736,       g: "https://www.google.com/maps/search/?api=1&query=中央市場 米粉 新竹",       formLink: "#"     },     {       id: "old",       zh: { name: "老新竹米粉（城隍廟周邊）", desc: "傳統作法，清爽耐吃" },       en: { name: "Old Hsinchu Rice Noodles", desc: "Traditional style near the temple" },       lat: 24.8035,        lng: 120.9660,       g: "https://www.google.com/maps/search/?api=1&query=老新竹 米粉 城隍廟",       formLink: "#"     }   ];    let lang = "zh";   const map = L.map('map').setView([24.8039, 120.9698], 15);      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {     maxZoom: 19,     attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'   }).addTo(map);    // 創建紅色標記圖標   const redIcon = new L.Icon({     iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png',     shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png',     iconSize: [30, 46],     iconAnchor: [15, 46],     popupAnchor: [1, -34],     shadowSize: [46, 46]   });    const markers = {};      // 渲染地圖標記   function renderMarkers() {     // 清除現有標記     Object.values(markers).forEach(marker => map.removeLayer(marker));          shops.forEach(shop => {       // 創建標記       const marker = L.marker([shop.lat, shop.lng], { icon: redIcon }).addTo(map);              // 添加彈出視窗       marker.bindPopup(`         <div style="min-width:220px">           <h4 style="margin:0 0 8px;color:#c62828">${lang === 'zh' ? shop.zh.name : shop.en.name}</h4>           <p style="margin:0 0 10px">${lang === 'zh' ? shop.zh.desc : shop.en.desc}</p>           <a href="${shop.g}" target="_blank" style="             display:inline-block;             background:#c62828;             color:white;             padding:6px 12px;             border-radius:4px;             text-decoration:none;             font-weight:bold;           ">查看地圖</a>         </div>       `);              // 存儲標記       markers[shop.id] = marker;     });   }    // 從Google表單獲取評分數據（模擬）   function fetchRatings() {     // 模擬API請求延遲     return new Promise(resolve => {       setTimeout(() => {         // 模擬從Google表單獲取的數據         const ratingsData = {           dongmen: { avg: 4.7, count: 24 },           acheng: { avg: 4.5, count: 32 },           temple: { avg: 4.3, count: 18 },           zhenji: { avg: 4.2, count: 15 },           central: { avg: 4.0, count: 12 },           old: { avg: 4.4, count: 20 }         };         resolve(ratingsData);       }, 800);     });   }    // 星級評分UI   function renderStarRating(shopId) {     const userRating = Number(localStorage.getItem(`rate_${shopId}`) || 0);     let starsHTML = '<div class="stars">';          for (let i = 1; i <= 5; i++) {       starsHTML += `<span class="star ${i <= userRating ? 'active' : ''}"                            data-value="${i}"                           data-shop="${shopId}">★</span>`;     }          starsHTML += '</div>';     return starsHTML;   }    // 渲染店家列表   async function renderShopList() {     const el = document.getElementById('shopList');     const ratingsData = await fetchRatings();          el.innerHTML = shops.map(shop => {       const shopData = lang === 'zh' ? shop.zh : shop.en;       const rating = ratingsData[shop.id] || { avg: 0, count: 0 };              return `         <div class="shop-card">           <div class="shop-header">             <h3>${shopData.name}</h3>           </div>           <div class="shop-body">             <p class="shop-desc">${shopData.desc}</p>                          <div class="rating-section">               <div class="rating-title">                 <i class="fas fa-star"></i> ${lang === 'zh' ? '評分資訊' : 'Rating Info'}               </div>                              <div class="rating-display">                 <span class="avg-rating">${rating.avg.toFixed(1)}</span>                 <span class="rating-count">(`latex-inlineEquation {lang === 'zh' ? '基於' : 'from'} `{rating.count} ${lang === 'zh' ? '則評分' : 'ratings'})</span>               </div>                              ${renderStarRating(shop.id)}                              <div class="user-rating">                 ${lang === 'zh' ? '您的評分：' : 'Your rating:'}                  `latex-inlineEquation {localStorage.getItem(`rate_`{shop.id}`) || '0'} ⭐               </div>             </div>                          <div class="shop-actions">               <a href="${shop.g}" target="_blank" class="action-btn map-btn">                 <i class="fas fa-map-marked-alt"></i>                  ${lang === 'zh' ? '查看地圖' : 'View Map'}               </a>               <a href="${shop.formLink}" target="_blank" class="action-btn rate-btn">                 <i class="fas fa-pencil-alt"></i>                  ${lang === 'zh' ? '我要評分' : 'Rate Shop'}               </a>             </div>           </div>         </div>       `;     }).join('');          // 添加星級評分事件監聽     document.querySelectorAll('.star').forEach(star => {       star.addEventListener('click', function() {         const shopId = this.getAttribute('data-shop');         const value = parseInt(this.getAttribute('data-value'));                  // 保存評分到localStorage         localStorage.setItem(`rate_${shopId}`, value);                  // 重新渲染列表以更新評分顯示         renderShopList();       });     });   }    // 應用語言設置   function applyLanguage() {     document.getElementById('title').textContent = lang === 'zh' ? '新竹米粉地圖' : 'Hsinchu Rice Noodle Map';     document.getElementById('routeTitle').textContent = lang === 'zh' ? '路線說明' : 'Route Guide';     document.getElementById('routeDesc').textContent = lang === 'zh'        ? '以新竹火車站與城隍廟為核心，步行可達的經典米粉店。點擊地圖紅點可查看並前往 Google 地圖。'       : 'Walkable classic rice noodle shops around Hsinchu Train Station and Chenghuang Temple. Click red markers for Google Maps.';     document.getElementById('listTitle').textContent = lang === 'zh'        ? '店家清單（可評分）' : 'Shop List (Rate it)';     document.getElementById('fbTitle').textContent = lang === 'zh' ? '意見回饋' : 'Feedback';     document.getElementById('fbDesc').textContent = lang === 'zh'        ? '此回饋僅儲存在你的瀏覽器（localStorage）'        : 'Feedback is stored locally in your browser.';     document.getElementById('foot').textContent = lang === 'zh'        ? '提示：評分與回饋使用瀏覽器 localStorage，重新整理仍會保留。'       : 'Tip: Ratings and feedback are saved locally via localStorage.';     document.querySelector('#langBtn span').textContent = lang === 'zh' ? 'EN' : '中文';          // 重新渲染地圖標記和店家列表     renderMarkers();     renderShopList();   }    // 初始化   document.addEventListener('DOMContentLoaded', () => {     // 語言切換按鈕     document.getElementById('langBtn').addEventListener('click', () => {       lang = lang === 'zh' ? 'en' : 'zh';       applyLanguage();     });          // 反饋文本框     const feedbackEl = document.getElementById('feedback');     feedbackEl.value = localStorage.getItem('feedback') || '';     feedbackEl.addEventListener('input', () => {       localStorage.setItem('feedback', feedbackEl.value);     });          // 應用初始語言設置     applyLanguage();   }); </script> </body> </html>
